angular.module("starter.servies",[]).factory("accountService",["globalServices","$state","$rootScope","$document","$compile",function(e,s,r,o,a){return{getAccount:function(s){s.accountInfo=e.userBaseMsg,e.post("3102","member",{}).then(function(r){s.accountInfo=r,s.$broadcast("scroll.refreshComplete"),e.setUserBaseMsg(angular.extend({token:e.userBaseMsg.token},r)),e.localStorageHandle("account",{mobile:r.mobile,password:e.localStorageHandle("account").password})},function(e){s.$broadcast("scroll.refreshComplete")})},setMemberName:function(r){e.serialPost("3103","memberName",{memberName:r}).then(function(o){e.setUserBaseMsg(angular.extend(e.userBaseMsg,{memberName:r})),s.go("tab.usermsg")})},bindMobile:function(r){e.serialPost("3103","mobile",{mobile:r}).then(function(o){e.setUserBaseMsg(angular.extend({mobile:r},e.userBaseMsg)),s.go("tab.usermsg",null,{reload:!0})})},modifyPassword:function(r){var o=md5(r.password),a=md5(r.oldPassword);r.password==r.repeatPassword&&e.serialPost("3103","password",{password:o,oldPassword:a}).then(function(r){e.localStorageHandle("account",{mobile:e.userBaseMsg.mobile,password:o}),s.go("tab.usermsg")})},setPassword:function(r){r.mobile=e.userBaseMsg.mobile;var o=md5(r.password);r.password==r.repeatPassword&&e.serialPost("3103","resetPassword",{mobile:r.mobile,password:o}).then(function(a){e.localStorageHandle("account",{mobile:r.mobile,password:o}),e.setUserBaseMsg(angular.extend(e.userBaseMsg,{setPassword:1})),s.go("tab.usermsg")})},orderList:function(s){var r=0;return function(o){o&&(r=0),r+=1,e.serialPost("2100","list",{page:r,pageSize:20}).then(function(e){o?(s.$broadcast("scroll.refreshComplete"),s.isMore=!0):(s.orders=s.orders.concat(e.orderList),s.$broadcast("scroll.infiniteScrollComplete")),e.itemTotal<15&&(s.isMore=!1)})}},share:function(e){var s='<div class="share-layer" ng-click="closeLayer()"><div class="row"> <div class="col" ng-click="shareHandle(1)"><img src="./img/usercenter/bt_weixin.png" /><br/>微信</div><div class="col" ng-click="shareHandle(2)"><img src="./img/usercenter/bt_pengyouquan.png" /><br/>朋友圈</div><div class="col" ng-click="shareHandle(3)"><img src="./img/usercenter/bt_weibo.png" /><br/>微博</div></div></div>',n=angular.element(s),t=r.$new();angular.extend(t,{closeLayer:function(){"use strict";n.remove()},shareHandle:e.shareHandle}),o.find("body").append(n),a(n)(t)}}}]);