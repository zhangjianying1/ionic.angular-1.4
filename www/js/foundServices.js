angular.module("starter.services",[]).factory("foundServices",["globalServices","$sce",function(e,t){return{responseDataHandle:function(t,n,o,i,c,s){return i.isOffLine?(t.$broadcast("scroll.refreshComplete"),void t.$broadcast("scroll.infiniteScrollComplete")):(1==o?(t[c]=i,t.isMore=!0,t.$broadcast("scroll.refreshComplete")):t[c]=t[c].concat(i),i.length<10&&(t.isMore=!1),t.$broadcast("scroll.infiniteScrollComplete"),void e.cache(c,i))},getBouns:function(t){e.post("4000","last").then(function(n){n.issue.bonusNumber=e.sliceNum(n.issue.bonusNumber),t.bonus=n.issue})},getDateById:function(t,n){var o=e.cache(t),i=[];return angular.forEach(o,function(e){e.id==n&&(i=e)}),i},consult:function(t){var n=0,o=this;return function(i){i?n=i:n+=1,e.serialPost("5000","newsList",{page:n,pageSize:10}).then(function(e){o.responseDataHandle(t,i,n,e.newsList,"consults",10)})}},getConsultByCode:function(n,o){e.post("5000","newsDetail",{articleCode:o}).then(function(e){e.news&&e.news.content&&(e.news.content=t.trustAsHtml(e.news.content)),n.consultDetail=e&&e.news})},notice:function(t){var n=0;return function(o){t.default.index===t.selfNotice.index&&(o?n=o:n+=1,e.serialPost("5000","noticeList",{page:n,pageSize:10}).then(function(i){o&&(t.selfNotice.isMore=!0,t.$broadcast("refreshComplete")),i.noticeList.length<10&&1==n?(t.selfNotice.isMore=!1,t.selfNotice.data=i.noticeList):t.selfNotice.data=t.selfNotice.data.concat(i.noticeList),e.cache("notices",i.noticeList)}))}},receiveNotice:function(t){var n=0,o=this;return function(i){if(t.default.index===t.pushNotice.index){i&&(n=0,t.selfNotice.isMore=!0,t.$broadcast("refreshComplete"));var c=e.localStorageHandle({key:"notices",page:n,pageSize:10})||[];angular.forEach(c,function(e){e.createTime=o.timeHandle(e.createTime)}),n+=1,1==n?(t.pushNotice.data=c,c.length<10&&(t.pushNotice.isMore=!1)):t.pushNotice.data=t.pushNotice.data.concat(c),t.$broadcast("scroll.infiniteScrollComplete")}}},getNoticeByCode:function(t,n){e.post("5000","noticeDetail",{noticeCode:n}).then(function(e){t.noticeDetail=e.notice})},getPushNoticeByCode:function(t,n){var o=e.localStorageHandle("notices");angular.forEach(o,function(e){e.pushNoticeCode==n&&(t.noticeDetail=e)})},timeHandle:function(e){var t=new Date(e),n=new Date,o=3600*n.getHours();return n.getTime()-t.getTime()<o?t.getHours()+":"+t.getMinutes():t.getMonth()+1+"/"+t.getDate()}}}]);