angular.module("starter.services",[]).factory("entryServices",["globalServices","$state","$rootScope","$document","$compile",function(o,e,r,s,a){return{setHeader:function(o){var e='<div class="login-header"><div on-tap="back()"><i class="ion ion-ios-arrow-back"></i></div></div>',t=angular.element(e),n=r.$new();return angular.extend(n,{back:function(){o.back(),t.remove()}}),s.find("body").append(t),a(t)(n),t},signIn:function(r,s){var a=md5(r.password);o.signIn({mobile:r.mobile,password:a},function(t){t.token?(o.localStorageHandle("account",{mobile:r.mobile,password:a}),o.setUserBaseMsg(t),s=s?s:"tab.account",e.go(s)):t.errCount>0?o.errorPrompt("用户名或密码错误"):0==t.errCount&&o.errorPrompt("用户已被锁定")})},createAccount:function(r){var s=md5(r.password);r.password==r.repeatPassword&&o.serialPost("3100","mobile",{mobile:r.mobile,testCode:r.testCode,password:s}).then(function(a){o.setUserBaseMsg(a),o.localStorageHandle("account",{mobile:r.mobile,password:s}),e.go("tab.account")})},forgetPassword:function(r,s){s=s?"tab.accountresetpassword":"tab.resetpassword",o.serialPost("3105","forgetPassword",r).then(function(o){e.go(s,{mobile:r.mobile})})},resetPassword:function(r,s){var a=md5(r.password);o.serialPost("3103","resetPassword",{mobile:r.mobile,password:a}).then(function(o){e.go(s)})}}}]);